(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-badd3dc4"],{"0314":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[1===e.questionType?a("div",{staticClass:"selects"},[a("div",{staticClass:"content"},[a("div",{staticClass:"prompt"},[e._v("请选择正确的答案：")]),a("div",{staticClass:"all-select"},e._l(e.selectOptions,(function(t,n){return a("div",{key:n,staticClass:"select-item",class:e.answerValue===t?"single-selected":"",on:{click:function(a){return e.selectAnswer(t)}}},[e._v(" "+e._s(t)+" ")])})),0)])]):2===e.questionType?a("div",{staticClass:"selects"},[a("div",{staticClass:"content"},[a("div",{staticClass:"prompt"},[e._v("请选择正确的答案：")]),a("div",{staticClass:"all-select"},e._l(e.selectOptions,(function(t,n){return a("div",{key:n,staticClass:"select-item",class:e.answerValue.indexOf(t)>-1?"single-selected":"",on:{click:function(a){return e.selectAnswer(t)}}},[e._v(" "+e._s(t)+" ")])})),0)])]):3===e.questionType?a("div",{staticClass:"answers"},[a("div",{staticClass:"remark"},[e._v("请选择正确的答案：")]),a("div",{staticClass:"buttons"},e._l(e.selectOptions,(function(t,n){return a("div",{key:n,class:e.answerValue===t?"selected":"",on:{click:function(a){return e.selectAnswer(t)}}},[e._v(" "+e._s(t)+" ")])})),0)]):a("div",{staticClass:"answers"},[a("div",{staticClass:"remark"},[e._v("请将您的答案写在下方的编辑框中")]),a("r-quill-editor",{attrs:{funType:e.modulePicture,content:e.selectValue,"max-height":"400px"},on:{change:e.editorChange}})],1),e._t("default")],2)},s=[],i=(a("c975"),a("a15b"),a("a434"),a("a9e3"),a("d3b7"),a("ac1f"),a("1276"),a("db13")),o={components:{RQuillEditor:function(){return a.e("chunk-134280e8").then(a.bind(null,"2afc"))}},props:{questionType:{type:Number,default:1},questionOption:{type:Number,default:0},btnName:{type:String,default:"提交"},ableReply:{type:Boolean,default:!0},modulePicture:{type:Number,default:1},answerValue:{type:String,default:""}},data:function(){return{judgeChoice:["对","错"],multiValue:this.selectValue?this.selectValue.split(""):[],selectValue:this.answerValue}},mounted:function(){},methods:{selectAnswer:function(e){if(this.ableReply){if(2===this.questionType){var t=this.multiValue.indexOf(e);t>-1?this.multiValue.splice(t,1):this.multiValue.push(e),this.selectValue=this.multiValue.sort().join("")}else this.selectValue=e;this.backValue()}},editorChange:function(e){this.selectValue=e,this.backValue()},backValue:function(){this.$emit("change",this.selectValue)}},computed:{selectOptions:function(){return 1===this.questionType||2===this.questionType?Object(i["x"])(this.questionOption):3===this.questionType?this.judgeChoice:void 0}},watch:{answerValue:function(e,t){e!==this.selectValue&&(this.selectValue=e,this.multiValue=this.selectValue?this.selectValue.split(""):[])}}},r=o,l=(a("d1ab"),a("2877")),c=Object(l["a"])(r,n,s,!1,null,"70a14622",null);t["default"]=c.exports},"08d4":function(e,t,a){},"0bc4":function(e,t,a){"use strict";a("4c1f")},"11f2":function(e,t,a){"use strict";a("a313")},"39cb":function(e,t,a){"use strict";a("4096")},4096:function(e,t,a){},"43b1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sckviewer"},[a("Calendar",{attrs:{ScheduledDate:e.MaterialDate,ChooseDate:e.ChooseDate},on:{Changed:e.DateChanged,"update:ScheduledDate":function(t){e.MaterialDate=t},"update:scheduled-date":function(t){e.MaterialDate=t},"update:ChooseDate":function(t){e.ChooseDate=t},"update:choose-date":function(t){e.ChooseDate=t}}}),a("p",{staticClass:"title"},[e._v(e._s(e.FormatDate(e.ChooseDate))+"录播资源")]),e.materials?a("div",{staticClass:"lists"},[a("ul",e._l(e.materials,(function(t,n){return a("li",{key:n},[a("div",[a("span",[e._v(e._s(t.RTStart))]),a("span",[e._v("~")]),a("span",[e._v(e._s(t.RTEnd))])]),a("div",[a("p",[a("span",[e._v(e._s(t.RTName))]),a("span",[e._v(e._s(t.Lesson))])]),a("p",{staticClass:"list_tcgrid"},[a("span",[e._v("教师："+e._s(t.Teachers))]),a("span",[e._v("班级："+e._s(t.Classes))])]),a("p",[a("span",[e._v(" 视频源： "),e._l(t.videos,(function(t,n){return a("el-dropdown",{key:n,staticClass:"video_source",attrs:{placement:"bottom"},on:{command:e.Play}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(t.title)+" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(t.videoSource,(function(t,n){return a("el-dropdown-item",{key:n,attrs:{command:t}},[e._v(e._s(t.MaterialName))])})),1)],1)}))],2),a("span",[a("el-dropdown",{staticClass:"video_download",on:{command:e.Download}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" 下载 "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(t.downloads,(function(t,n){return a("el-dropdown-item",{key:n,attrs:{command:t}},[e._v(e._s(t.MaterialName))])})),1)],1)],1)])])])})),0)]):e._e(),e.materials?e._e():a("div",{staticClass:"none"},[a("p",[e._v(e._s(e.FormatMonthDay(e.ChooseDate))+" 无资源")])]),a("el-dialog",{attrs:{"custom-class":"dlbPlayer",modal:!1,title:"播放",visible:e.ShowPlayer,"modal-append-to-body":!1,"close-on-click-modal":!1,"before-close":e.OnDlgPlayerClose,"destroy-on-close":!0,center:""},on:{"update:visible":function(t){e.ShowPlayer=t}}},[a("PlayBox",{ref:"PlayBox",attrs:{Videos:e.videoList},on:{"update:Videos":function(t){e.videoList=t},"update:videos":function(t){e.videoList=t}}})],1)],1)},s=[],i=(a("99af"),a("4de4"),a("4160"),a("d3b7"),a("159b"),a("96cf"),a("c964")),o=a("c1df"),r=a.n(o),l=a("a397"),c=a("67dc"),u={components:{Calendar:function(){return a.e("chunk-46a8bd6e").then(a.bind(null,"c192"))},PlayBox:function(){return a.e("chunk-461ba3a0").then(a.bind(null,"2b22"))}},props:{},data:function(){return{MaterialDate:[],ChooseDate:new Date,videoList:[],ShowPlayer:!1,materials:[]}},mounted:function(){var e=this.MonthHeadDate(this.ChooseDate),t=this.MonthEndDate(this.ChooseDate),a=this.DayHeadDate(this.ChooseDate),n=this.DayEndDate(this.ChooseDate);this.LoadData(e,t,a,n)},methods:{FormatDate:function(e){return r()(e).format("YYYY-MM-DD")},FormatMonthDay:function(e){return r()(e).format("MM-DD")},MonthHeadDate:function(e){return r()(e).format("YYYY-MM")+"-01 00:00:00"},MonthEndDate:function(e){return r()(e).format("Y-MM")+"-"+r()(r()(e).format("Y-MM"),"Y-MM").daysInMonth()+" 23:59:59"},DayHeadDate:function(e){return r()(e).format("YYYY-MM-DD")+" 00:00:00"},DayEndDate:function(e){return r()(e).format("YYYY-MM-DD")+" 23:59:59"},DateChanged:function(e){var t=this.MonthHeadDate(e),a=this.MonthEndDate(e),n=this.DayHeadDate(e),s=this.DayEndDate(e);this.LoadData(t,a,n,s)},LoadData:function(e,t,a,n){var s=this;return Object(i["a"])(regeneratorRuntime.mark((function i(){var o,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=s.$parent.$route.params.id,i.next=3,l["a"].Material.GetMaterialByDate(o,e,t,a,n);case 3:c=i.sent,s.MaterialDate=[],s.materials=null,c.Result?(c.Dates&&c.Dates.length>0&&c.Dates.forEach((function(e){s.MaterialDate.push(e.Time)})),c.Datas&&c.Datas.length>0&&(s.materials=[],c.Datas.forEach((function(e){var t=null,a=null,n=[],i=null,o=null,l=null;e.MaterialInfo&&(t=JSON.parse(e.MaterialInfo)),e.ScheduleInfo&&(a=JSON.parse(e.ScheduleInfo));var c=t.filter((function(e){return"2"===e.FrameType}));c.length>0&&(i={title:"老师",videoSource:[]},c.forEach((function(e){i.videoSource.push(e)})),n.push(i));var u=t.filter((function(e){return"1"===e.FrameType}));u.length>0&&(o={title:"学生",videoSource:[]},u.forEach((function(e){o.videoSource.push(e)})),n.push(o));var d=t.filter((function(e){return"0"===e.FrameType}));d.length>0&&(l={title:"课件",videoSource:[]},d.forEach((function(e){l.videoSource.push(e)})),n.push(l)),s.materials.push({RTStart:t?r()(t[0].RTStart).format("HH:mm:ss"):"",RTEnd:t?r()(t[0].RTEnd).format("HH:mm:ss"):"",RTName:e.RTName,Lesson:a?a.Lesson:"",Teachers:a?a.Teachers:"",Classes:a?a.Classes:"",videos:n,downloads:t})})))):s.$message({showClose:!0,message:c.Info,type:"error",duration:1e3});case 7:case"end":return i.stop()}}),i)})))()},OnDlgPlayerClose:function(){var e=this;this.videoList=[],this.$refs.PlayBox&&this.$refs.PlayBox.Dispose(),this.$nextTick((function(){e.ShowPlayer=!1}))},Play:function(e){var t=this;this.videoList=[],this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.RTID){a.next=6;break}return a.next=3,t.GetResourceList(e);case 3:t.videoList=a.sent,a.next=8;break;case 6:n=t.$root.DownloadURL+"?filename="+e.MaterialID+"&fileType=9","MP4"===e.Type&&t.videoList.push({url:n,id:e.MaterialID,name:e.MaterialName,MaterialStorePath:e.Path});case 8:t.ShowPlayer=!0;case 9:case"end":return a.stop()}}),a)}))))},GetResourceList:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=[],!e.MaterialInfo){a.next=4;break}return a.next=4,e.MaterialInfo.forEach((function(e){var a=t.$root.DownloadURL+"?filename="+e.MaterialID+"&fileType=9";"MP4"===e.Type&&n.push({url:a,id:e.MaterialID,name:e.MaterialName,MaterialStorePath:e.Path})}));case 4:return a.abrupt("return",n);case 5:case"end":return a.stop()}}),a)})))()},Download:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=c["a"].GetConfigInfo(),i=a("21a6"),!e){n.next=11;break}if(!e.RTID){n.next=10;break}return n.next=6,t.GetResourceList(e);case 6:o=n.sent,o.forEach((function(e){i.saveAs("http://".concat(s.Host,":").concat(s.Port,"/FJRH.Campus/MaterialService/Download?mid=").concat(e.id))})),n.next=11;break;case 10:i.saveAs("http://".concat(s.Host,":").concat(s.Port,"/FJRH.Campus/MaterialService/Download?mid=").concat(e.MaterialID));case 11:case"end":return n.stop()}}),n)})))()}}},d=u,f=(a("956c"),a("2877")),h=Object(f["a"])(d,n,s,!1,null,null,null);t["default"]=h.exports},"4c1f":function(e,t,a){},"4f59":function(e,t,a){},5414:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sub_module"},[e._m(0),a("Table",{ref:"table",attrs:{ShowTopBar:!1,ShowTblFoot:!1,ShowSelectColumn:!1,ShowExport:!1,Columns:e.tableColumns,Datas:e.dataList,Loading:e.dataLoading,showMaxeight:!1},on:{"update:Datas":function(t){e.dataList=t},"update:datas":function(t){e.dataList=t}},scopedSlots:e._u([{key:"oprate",fn:function(t){return[a("el-button",{staticStyle:{padding:"7px 15px"},attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.previewAnswer(t.row)}}},[e._v("查看答题 ")]),a("el-button",{staticStyle:{padding:"7px 15px"},attrs:{type:"success",size:"mini"},on:{click:function(a){return e.getScoreStats(t.row)}}},[e._v("得分统计 ")])]}}])}),a("el-dialog",{attrs:{title:"答题明细",visible:e.dialogDetailVisible,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogDetailVisible=t}}},[a("practice-detail",{ref:"PracticeDetail",attrs:{cpdata:e.selectData}})],1),a("el-dialog",{attrs:{title:"得分统计",visible:e.dialogScoreVisible,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogScoreVisible=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogScoreLoading,expression:"dialogScoreLoading"}],attrs:{data:e.dialogScoreList,"max-height":"550",stripe:"","default-sort":{prop:"Ranking",order:"ascending"}}},[a("el-table-column",{attrs:{property:"Ranking",label:"排名"}}),a("el-table-column",{attrs:{property:"StudentName",label:"学生姓名"}}),a("el-table-column",{attrs:{property:"SingleScore",label:"单选题"}}),a("el-table-column",{attrs:{property:"MultipleScore",label:"多选题"}}),a("el-table-column",{attrs:{property:"JudgeScore",label:"判断题"}}),a("el-table-column",{attrs:{property:"QandAScore",label:"问答题"}}),a("el-table-column",{attrs:{property:"TotalScore",label:"总分"}})],1)],1)],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"module_header"},[a("div",{staticClass:"title"},[e._v("随堂练习")])])}],i=(a("4160"),a("d3b7"),a("159b"),a("a397")),o=a("db13"),r={name:"ClassPractice",components:{Table:function(){return a.e("chunk-347ed62b").then(a.bind(null,"0748"))},PracticeDetail:function(){return a.e("chunk-461ba3a0").then(a.bind(null,"90d0"))}},data:function(){return{courseRecord:Object(o["v"])("campus_CourseRecord"),courseRecordID:Object(o["v"])("campus_CourseRecordID"),dataList:[],dataLoading:!1,tableColumns:[{Code:"CPTitle",Header:"名称",Width:300},{Code:"SubjectTotal",Header:"题数"},{Code:"SubjectScore",Header:"总分"},{Code:"CPTime",Header:"计时(分)"},{Code:"oprate",Header:"操作",Slot:!0,Width:450}],dialogScoreVisible:!1,dialogScoreList:[],dialogScoreLoading:!1,dialogDetailVisible:!1,selectData:{}}},created:function(){this.getClassPracticeStats()},methods:{getClassPracticeStats:function(){var e=this;this.dataLoading=!0,this.dataList=[],i["a"].IClassPractise.dataStatistics(this.courseRecordID).then((function(t){t.Result&&t.Datas&&t.Datas.length>0&&(t.Datas.forEach((function(t){e.dataList.push({CIPID:t.CIPID,CPID:t.Key.CPID,PLID:t.Key.PLID,CPTitle:t.PLTitle,SubjectTotal:t.Total,SubjectScore:t.Score,CPTime:t.CIPTime,CreateTime:t.Key.CreateTime,State:t.Key.State})})),e.$refs["table"].MaxTblHeight=500),e.dataLoading=!1})).catch((function(){e.dataLoading=!1}))},getScoreStats:function(e){var t=this;this.dialogScoreVisible=!0,this.dialogScoreList=[],this.dialogScoreLoading=!0,i["a"].IClassPractise.PractiseScoreStatistics(this.courseRecord.classID,e["CIPID"]).then((function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach((function(e){t.dialogScoreList.push(e)})),t.dialogScoreLoading=!1})).catch((function(){t.dialogScoreLoading=!1}))},previewAnswer:function(e){var t=this;this.selectData=e,this.dialogDetailVisible=!0,setTimeout((function(){t.$refs["PracticeDetail"].getSubjectData()}),100)}}},l=r,c=(a("cb7d"),a("2877")),u=Object(c["a"])(l,n,s,!1,null,"308da917",null);t["default"]=u.exports},6449:function(e,t,a){},"70f5":function(e,t,a){"use strict";a("6449")},"744a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clsroom-list"},[a("el-card",{staticClass:"living-plan",attrs:{shadow:"hover"}},[a("div",{staticClass:"info"},[a("span",{staticClass:"title"},[e._v("正在播放的计划")]),a("el-divider",{attrs:{direction:"vertical"}}),a("span",{staticClass:"desc"},[e._v("这是一条正在播放中的计划，它已经播放很久了")])],1),a("el-select",{staticClass:"select-imm",attrs:{size:"mini",placeholder:"即时广播"},on:{change:e.addFile},model:{value:e.immValue,callback:function(t){e.immValue=t},expression:"immValue"}},e._l(e.immOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0!==e.plans.length?a("el-card",{staticClass:"imm-file",attrs:{shadow:"hover"}},[a("div",{staticClass:"title"},[e._v("即时广播文件 "+e._s(e.plans.length)+" 条")]),a("div",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},e._l(e.plans,(function(t){return a("div",{key:t.value,staticClass:"con"},[a("div",{staticClass:"info"},[a("div",{staticClass:"detail"},[a("div",{staticClass:"file-name"},[a("span",[e._v("计划名称："+e._s(t.planName))]),a("span",[e._v("文件名称："+e._s(t.fileName))]),a("span",[e._v("类型："+e._s(t.fileType))]),a("span",[e._v("文件大小："+e._s(t.fileSize))])])])]),a("div",{staticClass:"op"},[a("span",{staticClass:"tip-text"},[e._v("请勾选要插播的教室")]),0==t.planEstate?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.CutIn(t)}}},[e._v("插播")]):e._e(),1==t.planEstate?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.StopBroad(t)}}},[e._v("停止")]):e._e(),0==t.planEstate?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.DelPlan(t)}}},[e._v("删除")]):e._e()],1)])})),0)]):e._e(),a("div",{ref:"divHeader",staticClass:"el-page-header"},[e._v(" 您的权限共教室 "),a("span",[e._v(e._s(e.TotalCount))]),e._v(" 间 ")]),a("FilterBar",{ref:"FilterBar",attrs:{FilterItems:e.FilterItems},on:{"update:FilterItems":function(t){e.FilterItems=t},"update:filter-items":function(t){e.FilterItems=t},Filter:e.Filter,ReSize:e.AdjustSize}}),a("el-card",{ref:"CountBar",staticClass:"countbar",attrs:{shadow:"hover"}},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.ReSelections},model:{value:e.CurEstate,callback:function(t){e.CurEstate=t},expression:"CurEstate"}},[a("el-radio-button",{attrs:{label:"all"}},[e._v(" 筛选结果共 "),a("span",{staticClass:"free"},[e._v(e._s(e.FilterCount))]),e._v(" 间 ")]),e.IsMINI?e._e():a("el-radio-button",{attrs:{label:"hasCls"}},[e._v(" 有排课 "),a("span",{staticClass:"hasCls"},[e._v(e._s(e.ScheduleCount))]),e._v(" 间 ")]),e.IsMINI?e._e():a("el-radio-button",{attrs:{label:"noCls"}},[e._v(" 未排课 "),a("span",{staticClass:"online"},[e._v(e._s(e.UnScheduleCount))]),e._v(" 间 ")]),a("el-radio-button",{attrs:{label:"using"}},[e._v(" 终端使用中 "),a("span",{staticClass:"using"},[e._v(e._s(e.UsingCount))]),e._v(" 间 ")]),a("el-radio-button",{attrs:{label:"free"}},[e._v(" 终端空闲 "),a("span",{staticClass:"online"},[e._v(e._s(e.FreeCount))]),e._v(" 间 ")]),a("el-radio-button",{attrs:{label:"offline"}},[e._v(" 终端离线 "),a("span",{staticClass:"offline"},[e._v(e._s(e.OfflineCount))]),e._v(" 间 ")])],1),a("el-button-group",[a("el-tooltip",{attrs:{placement:"top",content:"全部选择"}},[a("el-button",{attrs:{plain:"",type:"primary",size:"mini",icon:"iconfont icon_SelectAll"},on:{click:e.CheckALL}},[e._v("全选")])],1),a("el-tooltip",{attrs:{placement:"top",content:"反向选择"}},[a("el-button",{attrs:{plain:"",type:"primary",icon:"iconfont icon_ReverseSelect",size:"mini"},on:{click:e.ReverseCheck}},[e._v("反选")])],1),a("el-tooltip",{attrs:{placement:"top",content:"取消选择"}},[a("el-button",{attrs:{plain:"",type:"primary",icon:"iconfont icon_CancelSelect",size:"mini"},on:{click:e.UnCheckALL}},[e._v("取消")])],1)],1)],1),a("el-checkbox-group",{ref:"divRooms",staticClass:"rooms",class:"rooms_"+e.divRoomsCount,style:{height:e.newHeight+"px"},model:{value:e.Selections,callback:function(t){e.Selections=t},expression:"Selections"}},e._l(e.Rooms,(function(t){return a("el-tooltip",{key:t.ClsRoomID,staticClass:"item",attrs:{placement:"top",disabled:!0}},[!(e.FilterBuilds.length<=0||e.FilterBuilds.indexOf(t.BuildingID)>=0)||e.FilterClsRoomType&&e.FilterClsRoomType!==t.ClsRoomType||!("all"===e.CurEstate||"hasCls"===e.CurEstate&&t.hasCls||"noCls"===e.CurEstate&&!t.hasCls||"terminal"===e.CurEstate&&t.Terminal||"using"===e.CurEstate&&t.Terminal&&3===t.Terminal.State||"free"===e.CurEstate&&t.Terminal&&(0===t.Terminal.State||1===t.Terminal.State||2===t.Terminal.State)||"offline"===e.CurEstate&&t.Terminal&&-1===t.Terminal.State)?e._e():a("el-card",{class:{hasCls:t.hasCls,rec:1===t.Rec,live:1===t.Live},attrs:{shadow:"hover"},nativeOn:{click:function(a){return e.CardClick(t.ClsRoomID)},dblclick:function(a){return e.GoDetail(t.ClsRoomID)}}},[a("div",{staticClass:"title"},[a("el-checkbox",{ref:"chk_"+t.ClsRoomID,refInFor:!0,attrs:{label:t.ClsRoomID}},[e._v(e._s(t.ClsRoomName))]),a("div",{staticClass:"Mask"})],1),a("div",{staticClass:"info"},[a("span",[e._v("IP地址："+e._s(t.Terminal.IP))]),a("span",[e._v("广播中："+e._s(t.IPBName))])]),a("div",{staticClass:"content status"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":"",hidden:!t.Terminal||!t.Terminal.DifferIP}},[a("i",{staticClass:"iconfont icon_terminal",class:{offline:!t.Terminal||-1===t.Terminal.State,using:t.Terminal&&3===t.Terminal.State,ShuttingDown:t.Terminal&&1===t.Terminal.State,Opening:t.Terminal&&2===t.Terminal.State,free:t.Terminal&&0===t.Terminal.State}})]),a("i",{staticClass:"iconfont icon_broadcast",class:{offline:!t.IPBState,live:t.IPBState}})],1)])],1)})),1)],1)},s=[],i=(a("4de4"),a("7db0"),a("4160"),a("c975"),a("fb6a"),a("a434"),a("b680"),a("d3b7"),a("159b"),a("96cf"),a("c964")),o=a("a397"),r={components:{FilterBar:function(){return a.e("chunk-6446bb53").then(a.bind(null,"bc7a"))}},created:function(){var e=this;this.$parent.$on("FixArea",(function(t,n){if(1===n.level){var s=[];t.Children&&t.Children.forEach((function(e){s.push(e.id)})),e.FilterItems[1].Values=s}else e.FilterItems[1].Values=[t.id];var i=a("eb11"),o=JSON.stringify(e.FilterItems[1].Values);e.Filter("ClsRoom",i.compressToBase64(o.slice(1,o.length-1)))}))},beforeDestroy:function(){window.onresize=null,window.hub&&(window.hub.off("UpdateTimeUp",null),window.hub.off("ReceiveStatus",null),window.hub.off("ReceiveRBStatus",null),window.hub.off("UpdateGWLineState",null),window.hub.off("ReceiveIPBInfo",null),window.hub.off("ReceiveIPBImmediate",null),console.log("释放监听"))},mounted:function(){var e=this;this.$nextTick((function(){e.AdjustSize()})),window.onresize=function(){e.AdjustSize()},this.LoadData(),this.LoadImmData(),this.ListenTimer=window.setInterval((function(){e.Listen()}),1e3)},data:function(){return{IsHubOn:!1,IsMINI:!1,CurEstate:"all",divRoomsCount:8,FilterCount:0,ScheduleCount:0,UnScheduleCount:0,TerminalCount:0,UsingCount:0,FreeCount:0,OfflineCount:0,TotalCount:0,immValue:"",immOptions:[{label:"视频",value:"video"},{label:"音频",value:"audio"},{label:"文本",value:"text"},{label:"文档",value:"doc"},{label:"直播",value:"live"}],FilterBuilds:[],FilterClsRoomType:"",FilterItems:[{Type:"ClsRoomType",ShowMore:!1,Multiple:!1},{Type:"ClsRoom",TypeName:"教室区域",Level:2,Values:[],Multiple:!0}],newHeight:0,Rooms:[],Selections:[],ListenTimer:null,plans:[{name:"123123",type:"123123",size:"123123"},{name:"123123",type:"123123",size:"123123"},{name:"123123",type:"123123",size:"123123"}]}},methods:{Listen:function(){if(!this.IsHubOn&&window.hub){this.IsHubOn=!0;var e=this;window.hub.on("UpdateTimeUp",(function(t){e.GetScheduleDatas()})),window.hub.on("ReceiveIPBInfo",(function(t){e.UpdateIPBData(t)})),window.hub.on("ReceiveIPBImmediate",(function(t){e.LoadImmData()})),window.hub.on("ReceiveStatus",(function(t,a){var n=e.Rooms.find((function(e){return null!==e.Terminal&&(e.Terminal.DeviceSerialNo===t||e.ClsRoomID===t)}));if(null!=n){var s=JSON.parse(a);switch(s.IP!==n.Terminal.DeviceInfo.IP&&(n.Terminal.DifferIP=!0),s.State){case"Opened":n.Terminal.State=3;break;case"Opening":n.Terminal.State=2;break;case"ShuttingDown":n.Terminal.State=1;break;case"Shutdown":n.Terminal.State=0;break;case"OffLine":n.Terminal.State=-1;break}}e.StatisticalCount()})),window.hub.on("ReceiveRBStatus",(function(t){if(e.Rooms){var a=JSON.parse(t);e.Rooms.forEach((function(e){e.ClsRoomID===a.ClsRoomID&&(e.RB.REC=a.RECEstate)}))}e.StatisticalCount()})),window.hub.on("UpdateGWLineState",(function(t){t&&t.ClsRoomID&&e.Rooms&&e.Rooms.forEach((function(e){e.ClsRoomID===t.ClsRoomID&&(e.IOTState=t.State?1:0)}))}))}},UnCheckALL:function(){this.Selections=[]},ReverseCheck:function(){var e=this;this.Rooms.forEach((function(t){var a=e.Selections.indexOf(t.ClsRoomID);a<0?e.Selections.push(t.ClsRoomID):e.Selections.splice(a,1)})),this.ReSelections()},CheckALL:function(){var e=this;this.Rooms.forEach((function(t){e.Selections.indexOf(t.ClsRoomID)<0&&e.Selections.push(t.ClsRoomID)})),this.ReSelections()},CardClick:function(e){var t=this.Selections.indexOf(e);t>=0?this.Selections.splice(t,1):this.Selections.push(e)},GoDetail:function(e){this.$router.push("/control/dtl/".concat(e))},Filter:function(e,t){switch(e){case"ClsRoom":var n=a("eb11"),s="[".concat(n.decompressFromBase64(t),"]");this.FilterBuilds=JSON.parse(s);break;case"ClsRoomType":this.FilterClsRoomType=t;break}this.ReSelections(),this.StatisticalCount()},StatisticalCount:function(){var e=this;this.FilterCount=this.Rooms.filter((function(t){return(e.FilterBuilds.length<=0||e.FilterBuilds.indexOf(t.BuildingID)>=0)&&(!e.FilterClsRoomType||e.FilterClsRoomType===t.ClsRoomType)})).length,this.ScheduleCount=this.Rooms.filter((function(t){return(e.FilterBuilds.length<=0||e.FilterBuilds.indexOf(t.BuildingID)>=0)&&(!e.FilterClsRoomType||e.FilterClsRoomType===t.ClsRoomType)&&t.hasCls})).length,this.TerminalCount=this.Rooms.filter((function(t){return(e.FilterBuilds.length<=0||e.FilterBuilds.indexOf(t.BuildingID)>=0)&&(!e.FilterClsRoomType||e.FilterClsRoomType===t.ClsRoomType)&&t.Terminal})).length},ReSelections:function(){for(var e=this,t=function(t){var a=e.Rooms.find((function(a){return a.ClsRoomID===e.Selections[t]}));a?(!(e.FilterBuilds.length<=0||e.FilterBuilds.indexOf(a.BuildingID)>=0)||e.FilterClsRoomType&&e.FilterClsRoomType!==a.ClsRoomType||!("all"===e.CurEstate||"hasCls"===e.CurEstate&&a.hasCls||"noCls"===e.CurEstate&&!a.hasCls||"terminal"===e.CurEstate&&a.Terminal||"using"===e.CurEstate&&a.Terminal&&3===a.Terminal.State||"free"===e.CurEstate&&a.Terminal&&(0===a.Terminal.State||1===a.Terminal.State||2===a.Terminal.State)||"offline"===e.CurEstate&&a.Terminal&&-1===a.Terminal.State))&&e.Selections.splice(t,1):e.Selections.splice(t,1)},a=this.Selections.length-1;a>=0;a--)t(a)},LoadData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.TotalCount=0,e.Rooms=[],t.next=4,o["a"].ClsRoom.GetAllIPBRooms();case 4:if(a=t.sent,!a||!a.Datas){t.next=13;break}return a.Datas.forEach((function(t){var a=t.DeviceInfo?JSON.parse(t.DeviceInfo):null,n=null;a&&(n=a.find((function(e){return"1"===e.DeviceType}))),e.Rooms.push({ClsRoomID:t.ClsRoomInfo.ClsRoomID,ClsRoomName:t.ClsRoomInfo.ClsRoomName,BuildingID:t.ClsRoomInfo.BuildingID,ClsRoomType:t.ClsRoomInfo.ClsRoomType,IPBName:"",IPBState:!1,Terminal:n?{State:-1,DeviceSerialNo:n.DeviceSerialNo,ID:n.id,DeviceInfo:n.DeviceInfo,IP:n.DeviceInfo.IP,Port:n.DeviceInfo.Port,ModelCode:n.DeviceInfo.ModelCode,DifferIP:!1}:null})})),a.RBInfos&&a.RBInfos.forEach((function(t){e.Rooms.forEach((function(e){e.ClsRoomID===t.ClsRoomID&&(e.RB.REC=t.RECEstate)}))})),e.TotalCount=e.Rooms.length,t.next=11,o["a"].Ctrl.AllCtrlStates();case 11:n=t.sent,n&&n.Datas.forEach((function(t){var a=e.Rooms.find((function(e){return e.ClsRoomID===t.ClsRoomID||e.Terminal&&(e.Terminal.DeviceSerialNo===t.SerialNo||e.Terminal.DeviceInfo.IP===t.IP)}));if(a&&(a.Terminal||(a.Terminal={State:-1,DeviceSerialNo:t.SerialNo,DeviceInfo:{IP:t.IP,Port:t.Port,ModelCode:t.Model,BrandCode:t.Brand},DifferIP:!1}),a))switch(t.State){case"Opened":a.Terminal.State=3;break;case"Opening":a.Terminal.State=2;break;case"ShuttingDown":a.Terminal.State=1;break;case"Shutdown":a.Terminal.State=0;break;case"OffLine":a.Terminal.State=-1;break}}));case 13:a&&a.IPBStatusInfo&&e.UpdateIPBData(a.IPBStatusInfo),e.GetScheduleDatas(),e.StatisticalCount();case 16:case"end":return t.stop()}}),t)})))()},LoadImmData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].BP.GetImmediateDatas();case 2:a=t.sent,e.plans=[],a&&a.Datas&&a.Datas.forEach((function(t){var a="",n=0;switch(t.MaterialFileSize&&(n=(parseInt(t.MaterialFileSize)/1024/1024).toFixed(2)),t.BPLType){case"1":a="视频文件";break;case"2":a="音频文件";break;case"3":a="文本";break;case"4":a="文档文件";break;case"6":a="直播";break}e.plans.push({planName:t.BPLName,fileName:t.MaterialName,fileType:a,fileSize:n+" M",planEstate:t.Key.BPEstate,bpid:t.Key.BPID})}));case 5:case"end":return t.stop()}}),t)})))()},AdjustSize:function(){var e=document.querySelector(".plan-tab .el-tabs__content"),t=parseInt(window.getComputedStyle(e).height),a=parseInt(window.getComputedStyle(this.$refs.divHeader).height)+32,n=this.$refs.FilterBar?parseInt(window.getComputedStyle(this.$refs.FilterBar.$el).height):0,s=parseInt(window.getComputedStyle(this.$refs.CountBar.$el).height)+32;this.newHeight=t-a-(n>0?n-8:-16)-s,this.divRoomsCount=Math.floor(parseInt(window.getComputedStyle(this.$refs.divRooms.$el).width)/200);var i=parseInt(window.innerWidth);this.IsMINI=i<1920},GetScheduleDatas:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].Schedule.GetCurrentDatas();case 2:a=t.sent,e.Rooms.forEach((function(e){if(e.hasCls=!1,e.Teachers="",e.CourseName="",e.Classes="",a){var t=a.Datas.find((function(t){return t.Key.ClsRoomID===e.ClsRoomID}));if(t){e.hasCls=!0;var n=t.ThcINFO?JSON.parse(t.ThcINFO):[];n&&n.forEach((function(t,a){e.Teachers+=t.TeacherName,a<n.length-1&&(e.Teachers+="，")})),e.CourseName=t.CourseName;var s=t.ClassInfo?JSON.parse(t.ClassInfo):[];s&&s.forEach((function(t,a){e.Classes+=t.ClassName,a<s.length-1&&(e.Classes+="，")}))}}})),e.StatisticalCount();case 5:case"end":return t.stop()}}),t)})))()},UpdateIPBData:function(e){if(e){var t=JSON.parse(e);this.Rooms.forEach((function(e){e.IPBState=!1,e.IPBName="";var a=t.find((function(t){return t.IP===e.Terminal.IP}));a&&(e.IPBState=a.Online,1===a.Status&&(e.IPBName=a.Name))}))}},addFile:function(){this.$router.push("/ipb/file/add/".concat(this.immValue,"/1"))},CutIn:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s,i,r,l,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(t.Selections.length>0)){n.next=12;break}for(s="",i=function(e){var a=t.Rooms.find((function(a){return a.ClsRoomID===t.Selections[e]}));a?(a.Terminal&&(s+=a.Terminal.ID+","),t.Selections.splice(e,1)):t.Selections.splice(e,1)},r=t.Selections.length-1;r>=0;r--)i(r);return l=a("eb11"),s&&(s=l.compressToBase64(s.slice(0,s.length-1))),n.next=8,o["a"].BP.CutInIPB(e.bpid,s);case 8:c=n.sent,c&&c.Result?t.LoadImmData():(u="",c.Info?c.Info.forEach((function(e){u+=e+"\r\n"})):u="插播失败",t.$message({message:u,type:"warning",duration:1e3})),n.next=13;break;case 12:t.$message({message:"请选择插播的教室",type:"warning",duration:1e3});case 13:case"end":return n.stop()}}),n)})))()},StopBroad:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,o["a"].BP.StopImmediate(e.bpid);case 2:n=a.sent,n&&n.Result?t.LoadImmData():(s="",n.Info?n.Info.forEach((function(e){s+=e+"\r\n"})):s="停止失败",t.$message({message:s,type:"warning",duration:1e3}));case 4:case"end":return a.stop()}}),a)})))()},DelPlan:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,o["a"].BP.Delete(e.bpid);case 2:t.LoadImmData();case 3:case"end":return a.stop()}}),a)})))()}}},l=r,c=(a("39cb"),a("2877")),u=Object(c["a"])(l,n,s,!1,null,null,null);t["default"]=u.exports},"78c1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"practise_view"},[a("div",{staticClass:"practise_main"},[a("div",{staticClass:"head"},[a("div",[e._v(e._s(e.dataInfo["Title"]))]),a("div",[e._v("总分："+e._s(e.score))]),a("div",[e._v("习题数："+e._s(e.total||"0"))]),a("div",[e._v(" 时间: "+e._s(e.dataInfo["CreateTime"])+" ")])]),e.dataList&&e.dataList.length>0?a("el-timeline",e._l(e.dataList,(function(t,n){return a("el-timeline-item",{key:n,attrs:{placement:"top",timestamp:n+1+".【"+e.getPracticeTypeName(t.practiceInfo["PSType"])+"】"+(t.practiceInfo["PSScore"]||0)+"分"}},[a("el-card",[a("div",{staticClass:"title_info"},[e._v("【题目】"+e._s(t.practiceInfo["PSContent"]))]),[1,2].indexOf(t.practiceInfo["PSType"])>-1?a("div",e._l(t.practiceOptions,(function(t,n){return a("div",{key:n,staticClass:"options"},[a("span",[e._v("【"+e._s(t["SOSerial"])+"】")]),a("span",[e._v(e._s(t["SOContent"]))])])})),0):e._e(),a("my-answer",{attrs:{"question-type":t.practiceInfo["PSType"],"my-answer":t.practiceAnswer,"module-picture":e.modulePicture,"true-answer":t.practiceInfo["PSAnswer"],analysis:t.practiceInfo["PSanalysis"],hiddenScore:"","get-score":t.practiceReply?t.practiceReply["PAScore"]:0}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"survey_info"},[a("span",[e._v("问卷调研：")]),1===t.surveyMaster?a("el-button",{staticStyle:{padding:"12px 20px"},attrs:{size:"small",icon:"el-icon-check",type:"primary",disabled:""}},[e._v("已掌握 ")]):0===t.surveyMaster?a("el-button",{staticStyle:{padding:"12px 20px"},attrs:{size:"small",icon:"el-icon-close",type:"danger",disabled:""}},[e._v(" 未掌握 ")]):a("el-button",{staticStyle:{padding:"12px 20px"},attrs:{size:"small",type:"warning",disabled:""}},[e._v("未参与调研")])],1)],1)],1)})),1):a("r-lack-data"),a("div",{staticStyle:{"text-align":"right",padding:"15px 0"}},[a("el-button",{staticStyle:{padding:"12px 20px"},on:{click:function(t){return e.$emit("toClose")}}},[e._v("关闭")])],1)],1)])},s=[],i=(a("4160"),a("c975"),a("d3b7"),a("159b"),a("a397")),o=a("67dc"),r=a("ec0b"),l=a("bc3a"),c=a.n(l),u={name:"",components:{MyAnswer:function(){return a.e("chunk-461ba3a0").then(a.bind(null,"d023"))}},props:{dataInfo:{type:Object,default:function(){return{}}}},data:function(){return{fromID:this.dataInfo["CPID"]+"",bankID:this.dataInfo["PLID"]+"",taskId:this.dataInfo["CIPID"]+"",total:0,score:0,modulePicture:r["b"].PractiseAnswer,dataList:[],studentInfo:null}},created:function(){this.studentInfo=o["a"].GetStudentInfo()},methods:{init:function(){this.total=0,this.score=0,this.dataList=[],this.taskId=this.dataInfo["CIPID"]+"",this.fromID=this.dataInfo["CPID"]+"",this.libraryId=this.dataInfo["PLID"]+"",this.getPracticeInfo()},getPracticeInfo:function(){var e=this;i["a"].IClassPractise.StudentTaskStatistics(this.dataInfo["PLID"]+"").then((function(t){t.Result&&(e.total=t.Total,e.score=t.Score,e.getAllDataInfo())})).catch((function(){}))},getAllDataInfo:function(){for(var e=this,t=[],a=1;a<=this.total;a++)t.push(i["a"].IClassPractise.StudentTaskInfo(this.taskId,this.libraryId,a,this.studentInfo?this.studentInfo.StudentID:""));c.a.all(t).then(c.a.spread((function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];a.forEach((function(t,a){if(t.Result){var n=t.PSData,s=t.PAData?t.PAData:{},i=s["PAContent"]||"",o=null;s&&(o=s["PAMaster"]||null);var r=[];t.SOData&&t.SOData.length>0&&t.SOData.forEach((function(e){-1===r.indexOf(e)&&r.push(e)})),e.dataList.push({practiceInfo:n,practiceReply:s,practiceAnswer:i,surveyMaster:o,practiceOptions:r})}else e.dataList.push({})}))})))},getPracticeTypeName:function(e){return Object(r["c"])(e)}}},d=u,f=(a("f2da"),a("2877")),h=Object(f["a"])(d,n,s,!1,null,"0987370e",null);t["default"]=h.exports},"79e1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tooltip",{attrs:{content:"输入教师关键字可以进行模糊筛选",placement:e.TooltipPlacement}},[a("el-select",{attrs:{size:e.size,"popper-class":"selTeachers",filterable:"","allow-create":e.ArrowCreate,multiple:e.multiple,"multiple-limit":5,placeholder:e.Placeholder,"collapse-tags":"",remote:"",clearable:"","remote-method":e.remoteMethod,"reserve-keyword":"",loading:e.loading},on:{change:e.ChangeHandle},model:{value:e.Value,callback:function(t){e.Value=t},expression:"Value"}},e._l(e.Datas,(function(t){return a("el-option",{key:t.TeacherID,attrs:{label:t.TeacherName+" "+(e.ShowTeacherNo?"("+t.TeacherNo+"})":""),value:t.TeacherID,disabled:t.disabled}},[a("span",[e._v(e._s(t.TeacherName))]),a("span",[e._v(e._s(t.TeacherNo))]),""!==t.CSID&&t.CSID!==e.ExCSID?a("span",[e._v("已排课")]):e._e()])})),1)],1)},s=[],i=(a("99af"),a("7db0"),a("4160"),a("c975"),a("fb6a"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("159b"),a("96cf"),a("c964")),o=a("a397"),r=a("c1df"),l=a.n(r),c={props:{size:{type:String,default:"mini"},ArrowCreate:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},ScheduleDate:{},TooltipPlacement:{type:String,default:"right"},ExCSID:{type:String,default:""},ShowTeacherNo:{type:Boolean,default:!0},ScheduleLesson:{},value:{},Placeholder:{type:String,default:"请输入关键词"}},watch:{value:function(e,t){this.Value=e,e!==t&&(this.multiple?JSON.stringify(e)!==JSON.stringify(t)&&this.ReVerify():this.LoadData())},ScheduleDate:function(e,t){e!==t&&this.ReVerify()},ScheduleLesson:function(e,t){e!==t&&this.ReVerify()}},data:function(){return{loading:!1,Value:this.value,Datas:[]}},mounted:function(){this.LoadData()},methods:{ChangeHandle:function(e){var t=this;this.$emit("update:value",this.Value),this.$emit("Filter",this.Value);var a="";if(this.multiple){var n=[];this.Value.forEach((function(e){var a=t.Datas.find((function(t){return t.TeacherID===e}));a?n.push("".concat(a.TeacherName).concat(t.ShowTeacherNo?" ("+a.TeacherNo+"})":"")):n.push(e)})),a=JSON.stringify(n);var s=new RegExp('"',"g");a=a.slice(1,a.length-1).replace(s,"")}else{var i=this.Datas.find((function(t){return t.TeacherID===e}));a=i?"".concat(i.TeacherName).concat(this.ShowTeacherNo?" ("+i.TeacherNo+"})":""):this.Value}this.$emit("update:text",a)},remoteMethod:function(e){""!==e?(this.loading=!0,this.LoadData(e)):this.Datas=[]},ReVerify:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,!(e.Value&&e.Value.length>0)){t.next=8;break}return e.Value=[],t.next=5,o["a"].Teacher.GetDataByName("",l()(e.ScheduleDate).format("YYYY-MM-DD"),e.ScheduleLesson,e.multiple?JSON.stringify(e.value):"[".concat(JSON.stringify(e.value),"]"));case 5:a=t.sent,a&&(a.Datas&&a.Datas.forEach((function(t){e.$set(t,"disabled",!(""===t.CSID||t.CSID===e.ExCSID)),""!==t.CSID&&t.CSID!==e.ExCSID||e.value.indexOf(t.TeacherID)>=0&&e.Value.push(t.TeacherID)})),e.Datas=a.Datas,e.ArrowCreate&&e.value.forEach((function(t){e.Value.indexOf(t)<0&&e.Value.push(t)})),e.$emit("update:value",e.Value)),e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},LoadData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,o["a"].Teacher.GetDataByName(e,l()(t.ScheduleDate).format("YYYY-MM-DD"),t.ScheduleLesson,t.multiple?JSON.stringify(t.value):"[".concat(JSON.stringify(t.value),"]"));case 2:n=a.sent,n&&(n.Datas.forEach((function(e){t.$set(e,"disabled",!(""===e.CSID||e.CSID===t.ExCSID))})),t.Datas=n.Datas),t.loading=!1;case 5:case"end":return a.stop()}}),a)})))()}}},u=c,d=a("2877"),f=Object(d["a"])(u,n,s,!1,null,null,null);t["default"]=f.exports},8812:function(e,t,a){},"935a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sckviewer"},[a("Calendar",{attrs:{ScheduledDate:e.LogDate,ChooseDate:e.ChooseDate},on:{Changed:e.DateChanged,"update:ScheduledDate":function(t){e.LogDate=t},"update:scheduled-date":function(t){e.LogDate=t},"update:ChooseDate":function(t){e.ChooseDate=t},"update:choose-date":function(t){e.ChooseDate=t}}}),a("p",{staticClass:"title"},[e._v(e._s(e.FormatDate(e.ChooseDate))+"门禁信息")]),e.logs?a("div",{staticClass:"lists"},[a("ul",e._l(e.logs,(function(t,n){return a("li",{key:n},[a("div",{class:{prohibit:0===t.cardtype}},[a("span",[e._v(e._s(t.logTime))])]),a("div",[a("p",[a("span",[e._v("卡类型："+e._s(t.type))]),a("span",[e._v(e._s(t.valid))])]),a("p",[a("span",[e._v("教师："+e._s(t.teacher))])]),a("p",[a("span",[e._v("卡号："+e._s(t.card))])])])])})),0)]):e._e(),e.logs?e._e():a("div",{staticClass:"none"},[a("p",[e._v(e._s(e.FormatMonthDay(e.ChooseDate))+" 无日志")])])],1)},s=[],i=(a("4160"),a("d3b7"),a("159b"),a("96cf"),a("c964")),o=a("c1df"),r=a.n(o),l=a("a397"),c={components:{Calendar:function(){return a.e("chunk-46a8bd6e").then(a.bind(null,"c192"))}},props:{TerminalInfo:{type:Object,default:function(){return null}}},data:function(){return{LogDate:[],ChooseDate:new Date,logs:null}},mounted:function(){var e=this.MonthHeadDate(this.ChooseDate),t=this.MonthEndDate(this.ChooseDate),a=this.DayHeadDate(this.ChooseDate),n=this.DayEndDate(this.ChooseDate);this.LoadData(e,t,a,n)},methods:{FormatDate:function(e){return r()(e).format("YYYY-MM-DD")},FormatMonthDay:function(e){return r()(e).format("MM-DD")},MonthHeadDate:function(e){return r()(e).format("YYYY-MM")+"-01 00:00:00"},MonthEndDate:function(e){return r()(e).format("Y-MM")+"-"+r()(r()(e).format("Y-MM"),"Y-MM").daysInMonth()+" 23:59:59"},DayHeadDate:function(e){return r()(e).format("YYYY-MM-DD")+" 00:00:00"},DayEndDate:function(e){return r()(e).format("YYYY-MM-DD")+" 23:59:59"},DateChanged:function(e){var t=this.MonthHeadDate(e),a=this.MonthEndDate(e),n=this.DayHeadDate(e),s=this.DayEndDate(e);this.LoadData(t,a,n,s)},LoadData:function(e,t,a,n){var s=this;return Object(i["a"])(regeneratorRuntime.mark((function i(){var o,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=s.$parent.$route.params.id,i.next=3,l["a"].Ctrl.GetEntranceLogByDate(o,e,t,a,n);case 3:c=i.sent,s.LogDate=[],s.logs=null,c.Result?(c.Dates&&c.Dates.length>0&&c.Dates.forEach((function(e){s.LogDate.push(e.logTime)})),c.LogInfo&&c.LogInfo.length>0&&(s.logs=[],c.LogInfo.forEach((function(e){var t="",a="通过";switch(e.CardType){case 0:t="无效卡",a="禁止";break;case 1:t="教师卡";break;case 2:t="白名单";break;case 3:t="网管操作";break}s.logs.push({logTime:r()(e.logTime).format("HH:mm:ss"),type:t,cardtype:e.CardType,valid:a,teacher:e.TeacherName,card:e.CardNo})})))):s.$message({showClose:!0,message:c.Info,type:"error",duration:1e3});case 7:case"end":return i.stop()}}),i)})))()}}},u=c,d=(a("11f2"),a("2877")),f=Object(d["a"])(u,n,s,!1,null,null,null);t["default"]=f.exports},"956c":function(e,t,a){"use strict";a("4f59")},a0a6:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:"评价详情",visible:e.visible,"append-to-body":!0,"custom-class":"eva-list",size:"800px",direction:"rtl"},on:{"update:visible":function(t){e.visible=t},close:e.Close}},[a("div",{attrs:{name:"title"}},[a("span",[e._v("教师名称："+e._s(e.data.TeacherName))]),a("span",[e._v("课程名称："+e._s(e.data.CourseName))]),"ReportStatistics"==e.mCode?a("div",{staticStyle:{float:"right"}},[a("span",[e._v("综合得分："+e._s(this.avgScore))])]):e._e()]),a("Table",{attrs:{ModuleCode:e.mCode,ShowExport:!1,ShowCreate:!1,KeyFileld:"RFID",Columns:e.Columns,SortField:e.SortField,SortDir:e.SortDir,Datas:e.Datas,PageIndex:e.PageIndex,PageSize:e.PageSize,TotalCounts:e.TotalCounts,BaseForm:e.BaseForm,SearchKey:e.SKey,SearchValue:e.Key,UnNeedEstateBtn:!0,UnNeedDelBtn:!0,ShowSelectColumn:!1},on:{"update:SortField":function(t){e.SortField=t},"update:sort-field":function(t){e.SortField=t},"update:SortDir":function(t){e.SortDir=t},"update:sort-dir":function(t){e.SortDir=t},"update:Datas":function(t){e.Datas=t},"update:datas":function(t){e.Datas=t},"update:PageIndex":function(t){e.PageIndex=t},"update:page-index":function(t){e.PageIndex=t},"update:PageSize":function(t){e.PageSize=t},"update:page-size":function(t){e.PageSize=t},"update:BaseForm":function(t){e.BaseForm=t},"update:base-form":function(t){e.BaseForm=t},"update:SearchKey":function(t){e.SKey=t},"update:search-key":function(t){e.SKey=t},"update:SearchValue":function(t){e.Key=t},"update:search-value":function(t){e.Key=t},LoadData:e.LoadData},scopedSlots:e._u([{key:"oprateA",fn:function(t){return[a("el-button",{staticClass:"btnViewData",attrs:{onfocus:"this.blur()",type:"primary",icon:"el-icon-document",size:"mini",plain:""},on:{click:function(a){return e.Detail(t.row)}}},[e._v("详情")])]}}])})],1)},s=[],i=(a("99af"),a("4160"),a("a434"),a("a9e3"),a("b680"),a("d3b7"),a("159b"),a("96cf"),a("c964")),o=a("a397"),r={props:{data:{},show:{type:Boolean,default:!1},mCode:{type:String,default:""}},data:function(){return{Loading:!1,visible:!1,Columns:[{Code:"UserName",Header:"评价人"},{Code:"typeName",Header:"评价人角色"},{Code:"RFCreateDate",Header:"评价时间"},{Code:"score",Header:"分数",Width:"60"},{Code:"oprateA",Header:"操作",Width:"120",Slot:!0}],Datas:[],PageIndex:1,PageSize:10,TotalCounts:0,Key:"",SKey:"",SortField:"",SortDir:0,Estate:"",BaseForm:{},id:"",avgScore:0}},components:{Table:function(){return a.e("chunk-347ed62b").then(a.bind(null,"0748"))}},mounted:function(){"ReportStatistics"===this.mCode&&this.Columns.splice(4,0,{Code:"fullScore",Header:"满分值",Width:"60"},{Code:"line",Header:"合格线",Width:"60"})},watch:{show:function(e){this.visible=e,e&&this.LoadData()}},methods:{Detail:function(e){console.log("aaa"),this.$router.push("/eval/dtl/0/".concat(e.EVALPID,"/").concat(e.RFID,"/").concat(e.CSID,"/").concat(e.GaugeID))},Close:function(){this.PageIndex=1,this.PageSize=20,this.$emit("update:show",!1)},LoadData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a="","ReportStatistics"!==e.mCode){t.next=7;break}return t.next=4,o["a"].EVALPlan.GetExeOfEPlanDetailByCourseID(e.data.CourseID,e.PageIndex,e.PageSize,"",0);case 4:a=t.sent,t.next=10;break;case 7:return t.next=9,o["a"].EVALPlan.GetExecutionOfEPlanDetailByID(e.data.EVALPID,-1,e.PageIndex,e.PageSize,"",0);case 9:a=t.sent;case 10:e.avgScore=0,a&&a.Datas&&a.Datas.length>0?(a.Datas.forEach((function(t){t.score=Number(t.score).toFixed(2),"2"===t.usertype?t.typeName="学生":t.typeName="老师",e.avgScore=e.avgScore+Number(t.score),"ReportStatistics"===e.mCode&&(t.fullScore=Number(t.fullScore).toFixed(2),t.line=Number(t.line).toFixed(2))})),e.avgScore=(e.avgScore/a.Datas.length).toFixed(2),e.Datas=a.Datas,e.TotalCounts=a.rowsCount):(e.Datas=[],e.TotalCounts=0);case 12:case"end":return t.stop()}}),t)})))()}}},l=r,c=(a("70f5"),a("2877")),u=Object(c["a"])(l,n,s,!1,null,null,null);t["default"]=u.exports},a313:function(e,t,a){},b18d:function(e,t,a){},cb69:function(e,t,a){"use strict";a("8812")},cb7d:function(e,t,a){"use strict";a("b18d")},d1ab:function(e,t,a){"use strict";a("e9d8")},def0:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group_discussion"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.discussSubjectLoading,expression:"discussSubjectLoading"}],attrs:{data:e.subjectList,stripe:"",type:"expand","default-sort":{prop:"subject.createTime",order:"descending"}}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Table",{style:{minHeight:"50px"},attrs:{ShowTopBar:!1,ShowTblFoot:!1,ShowSelectColumn:!1,ShowExport:!1,Columns:e.tableColumns,Datas:t.row.groupList,showMaxeight:!1},on:{"update:Datas":function(a){return e.$set(t.row,"groupList",a)},"update:datas":function(a){return e.$set(t.row,"groupList",a)}},scopedSlots:e._u([{key:"oprate",fn:function(n){return[a("el-button",{staticStyle:{padding:"7px 15px"},attrs:{type:"warning",icon:"el-icon-view",size:"mini"},on:{click:function(a){return e.viewDetail(n.row,t.row.subject)}}},[e._v(" 查看明细 ")])]}}],null,!0)})]}}])}),a("el-table-column",{attrs:{property:"subject.gsSort",width:"120",label:"话题序号"}}),a("el-table-column",{attrs:{property:"subject.content",label:"讨论题目"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.subject.type?a("span",[e._v(e._s(t.row.subject.content))]):a("el-popover",{attrs:{trigger:"click"}},[a("img",{attrs:{src:t.row.subject.img,alt:""}}),a("img",{staticClass:"table_img",attrs:{slot:"reference",src:t.row.subject.img,alt:""},slot:"reference"})])]}}])}),a("el-table-column",{attrs:{property:"subject.time",width:"130",label:"讨论时长(分)"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.subject.time?a("span",[e._v(e._s(t.row.subject.time))]):a("span",[e._v("无限制")])]}}])}),a("el-table-column",{attrs:{property:"subject.createTime",width:"150",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatDate(t.row.subject.createTime,"yyyy-MM-dd hh:mm")))])]}}])}),a("el-table-column",{attrs:{property:"subject.state",width:"120",label:"状态"}})],1),a("el-dialog",{attrs:{title:"小组讨论记录",visible:e.dialogVisible,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"summary"},[a("div",[e._v(" 总得分: "),a("span",[e._v(e._s(e.score))])]),a("div",[e._v(" 总点赞: "),a("span",[e._v(e._s(e.good))])]),a("div",[e._v(" 讨论时长: "),a("span",[e._v(e._s(0===e.dataInfo.time?"无限制":e.dataInfo.time))])])]),a("div",{ref:"chat",staticClass:"chat"},[a("div",{staticClass:"chat_title"},[a("span",{staticClass:"chat_title_left"},[e._v("[论题]")]),e.dataInfo.type===e.contentTypeDefault?a("span",[e._v(e._s(e.dataInfo.content))]):a("el-popover",{attrs:{trigger:"click"}},[a("img",{style:{maxWidth:"800px",maxHeight:"500px"},attrs:{src:e.dataInfo.img,alt:""}}),a("img",{style:{maxWidth:"350px",maxHeight:"150px"},attrs:{slot:"reference",src:e.dataInfo.img,alt:""},slot:"reference"})])],1),e.dataList&&e.dataList.length>0?a("div",{staticClass:"chat_content"},e._l(e.dataList,(function(t,n){return a("div",{key:n,class:t.studentId!==e.selectStudentId?"chat_item":"chat_item checked_item"},[a("div",{staticClass:"chat_news"},[a("div",{staticClass:"chat_news_name"},[e._v(" "+e._s(t.name)+" "),a("span",[e._v(e._s(t.time))]),t.score?a("span",{staticClass:"chat_comment"},[e._v("+"+e._s(t.score||0)+"分")]):e._e()]),a("el-badge",{attrs:{type:"warning",value:t.thumb>0?"赞":""}},[a("div",{staticClass:"chat_news_cont"},[t.type===e.contentTypeDefault?a("span",[e._v(e._s(t.postContent))]):a("el-popover",{attrs:{trigger:"click"}},[a("img",{style:{maxWidth:"800px",maxHeight:"500px"},attrs:{src:t.postImg,alt:""}}),a("img",{style:{maxWidth:"350px",maxHeight:"150px"},attrs:{slot:"reference",src:t.postImg,alt:""},slot:"reference"})])],1)])],1)])})),0):e._e()])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"list_head"},[e._v("小组成员")]),a("div",{staticClass:"list_person"},e._l(e.personList,(function(t,n){return a("div",{key:n,staticClass:"person_item",class:e.selectStudentId===t["StudentID"]?"person_selected":"",on:{click:function(a){e.selectStudentId=t["StudentID"]}}},[a("img",{directives:[{name:"real-img",rawName:"v-real-img",value:[t["UserID"],t["StudentID"]],expression:"[item['UserID'], item['StudentID']]"}],attrs:{src:"",alt:""}}),a("span",[e._v(e._s(t["StudentName"]))]),a("div",[a("span",[e._v(e._s(t["TotalScore"])+"分")]),a("span",[e._v(e._s(t["TotalGood"])+"赞")])])])})),0)])],1)],1)],1)},s=[],i=(a("c740"),a("4160"),a("d3b7"),a("159b"),a("f3f3")),o=a("a397"),r=a("67dc"),l=a("db13"),c=a("ec0b"),u={name:"GroupDiscussion",components:{Table:function(){return a.e("chunk-347ed62b").then(a.bind(null,"0748"))}},data:function(){return{courseRecordID:Object(l["v"])("campus_CourseRecordID"),courseRecord:Object(l["v"])("campus_CourseRecord"),discussSubjectList:[],discussSubjectLoading:!1,subjectList:[],tableColumns:[{Code:"groupName",Header:"小组名称",width:300},{Code:"good",Header:"获赞"},{Code:"score",Header:"总分"},{Code:"oprate",Header:"操作",Slot:!0,width:240}],dialogVisible:!1,dataInfo:{},dataList:[],score:0,good:0,contentTypeDefault:c["a"].Text,personList:[],personLoading:!1,selectStudentId:""}},created:function(){this.initSelect()},methods:{getPicture:function(e,t){return this.$root.PictureURL+"?fileName="+e+"&fileType="+t+"&platFormType=1"},initSelect:function(){var e=this;this.$nextTick((function(){e.getDiscussSubjectList()}))},getDiscussSubjectList:function(){var e=this;this.discussSubjectList=[],this.discussSubjectLoading=!0,this.subjectList=[];var t=r["a"].GetStudentInfo();o["a"].IGroupWall.StudentDataInfo(this.courseRecordID,t?t.StudentID:"").then((function(t){t.Result&&t.Datas&&t.Datas.length>0&&t.Datas.forEach((function(t){e.discussSubjectList.push(Object(i["a"])(Object(i["a"])({},t),{},{img:e.getPicture(t["Key"]["GSContent"],c["b"].GroupSubject)}));var a={type:t["Key"]["GSForm"],time:t["Key"]["GSTime"],content:t["Key"]["GSContent"],gsSort:t["Key"]["GSSort"],createTime:t["Key"]["CreateTime"],img:1===t["Key"]["GSForm"]?"":e.getPicture(t["Key"]["GSContent"],c["b"].GroupSubject),state:1===t["Key"]["State"]?"进行中":"结束讨论"},n={subjectId:t["Key"]["GSID"],groupId:t["Key"]["GroupID"],groupName:t["GroupName"],good:t["TotalGood"],score:t["TotalScore"]},s=e.subjectList.findIndex((function(e){return JSON.stringify(e.subject)===JSON.stringify(a)}));s>-1?e.subjectList[s].groupList.push(n):e.subjectList.push({subject:a,groupList:[n]})})),e.discussSubjectLoading=!1})).catch((function(){e.discussSubjectLoading=!1}))},formatDate:function(e,t){return Object(l["f"])(e,t)},viewDetail:function(e,t){this.dataInfo=t,this.good=e.good||0,this.score=e.score||0,this.getDiscussionDetail(e),this.getGroupMember(e),this.dialogVisible=!0},getDiscussionDetail:function(e){var t=this;this.dataList=[],o["a"].IGroupWall.DataInfo(e.subjectId).then((function(e){e.Result&&e["GAData"]&&e["GAData"].length>0&&e["GAData"].forEach((function(e){var a={id:e["Key"]["GDID"],subjectId:e["Key"]["GSID"],studentId:e["StudentID"],name:e["StudentName"],type:e["Key"]["GDForm"],postImg:e["Key"]["GDForm"]===c["a"].Picture?t.getPicture(e["Key"]["GDContent"],c["b"].GroupDiscuss):"",postContent:e["Key"]["GDForm"]===c["a"].Picture?"":e["Key"]["GDContent"],time:t.formatDate(e["Key"]["SubmitTime"],"hh:mm:ss"),thumb:e["Key"]["GDGood"],isThumb:0,score:e["Key"]["GDScore"]};t.dataList.push(a)}))}))},getGroupMember:function(e){var t=this;this.personLoading=!0,this.personList=[],o["a"].IGroup.SubjectMemberRank(e.groupId,e.subjectId).then((function(e){e.Result&&e.Datas&&e.Datas.length>0&&(e.Datas.forEach((function(e){t.personList.push(e)})),t.selectStudentId=e.Datas[0]["StudentID"]),t.personLoading=!1})).catch((function(){t.personLoading=!1}))},preview:function(){}}},d=u,f=(a("cb69"),a("2877")),h=Object(f["a"])(d,n,s,!1,null,"2d0cb3bc",null);t["default"]=h.exports},e80e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"class-practice"},[a("div",{staticClass:"item-hd"},[a("div",{staticClass:"line-title"},[e._v("随堂练习")]),a("div",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchData}},[e._v("刷新")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.$router.push("/p/mq")}}},[e._v("我的题库")]),a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabled},on:{click:e.addData}},[e._v(" "+e._s(2===e.attribute?"练习添加":"布置练习")+" ")])],1)]),a("Table",{ref:"table",attrs:{ShowTopBar:!1,ShowTblFoot:!1,ShowSelectColumn:!1,ShowExport:!1,Columns:e.dataColumn,Loading:e.searchLoading,Datas:e.dataList,UnNeedEstateBtn:!0,showMaxeight:!1},on:{"update:Datas":function(t){e.dataList=t},"update:datas":function(t){e.dataList=t},LoadData:e.searchData},scopedSlots:e._u([{key:"className",fn:function(t){return[a("div",{staticStyle:{"min-width":"130px","white-space":"normal"}},[e._v(e._s(t.row.className))])]}},{key:"createTime",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.createTime,t.row.createTime)))])]}},{key:"operate",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{plain:"",type:"success",size:"mini",icon:"el-icon-edit",onfocus:"this.blur()",disabled:e.disabled},on:{click:function(a){return e.editData(t.row)}}},[e._v(" 修改 ")]),a("el-button",{attrs:{plain:"",type:"warning",size:"mini",icon:"el-icon-view",onfocus:"this.blur()"},on:{click:function(a){return e.beforeShowPreview(t.row)}}},[e._v(" 预览 ")]),a("el-button",{attrs:{plain:"",type:"danger",size:"mini",icon:"el-icon-close",onfocus:"this.blur()",disabled:e.disabled},on:{click:function(a){return e.dataDrop(t.row)}}},[e._v(" 移除 ")]),2!==t.row.attribute?a("el-button",{attrs:{plain:"",type:"primary",size:"mini",icon:"el-icon-time",onfocus:"this.blur()"},on:{click:function(a){return e.studentTask(t.row)}}},[e._v(" 学生完成进度 ")]):e._e()],1)]}}])}),a("el-dialog",{attrs:{title:e.dataEdit?"随堂练习修改":"随堂练习创建",visible:e.showEdit,"close-on-click-modal":!1,"modal-append-to-body":!1,width:"600px",center:""},on:{"update:visible":function(t){e.showEdit=t},close:e.closeDialog}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rulesTitle,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"试卷题库",prop:"libraryID"}},[a("el-select",{staticStyle:{width:"calc(100% - 80px)"},attrs:{placeholder:"请选择试卷题库"},model:{value:e.form.libraryID,callback:function(t){e.$set(e.form,"libraryID",t)},expression:"form.libraryID"}},e._l(e.practiceLibraryList,(function(t,n){return a("el-option",{key:n,attrs:{label:t.label,disabled:e.usedLibrary.indexOf(t.value)>-1&&t.value!==e.form.libraryID,value:t.value}})})),1),a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"primary",size:"small"},on:{click:e.getPracticeLibraryList}},[e._v("刷新 ")])],1),2!==e.attribute?a("el-form-item",{attrs:{label:"布置班级",prop:"classID"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择布置班级"},model:{value:e.form.classID,callback:function(t){e.$set(e.form,"classID",t)},expression:"form.classID"}},e._l(e.classOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showEdit=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",loading:e.btnLoading,type:"primary"},on:{click:function(t){return e.saveForm("form")}}},[e._v("保存")])],1)],1)],1),a("el-dialog",{attrs:{title:"随堂练习预览",visible:e.showPreview,"close-on-click-modal":!1,"modal-append-to-body":!1,width:"800px",center:""},on:{"update:visible":function(t){e.showPreview=t},close:e.closePreviewDialog}},[a("div",{staticClass:"pre_title",staticStyle:{"margin-top":"-20px"}},[a("span",[e._v("题库名称：")]),a("span",[e._v(e._s(e.dataInfo.title))])]),a("div",{staticClass:"pre_line"},[a("span",[e._v("试卷计时：")]),a("span",[e._v(e._s(e.dataInfo.time))]),a("span",[e._v("总题数：")]),a("span",[e._v(e._s(e.dataInfo.subjectList.length))]),a("span",[e._v("总分数：")]),a("span",[e._v(e._s(e.dataInfo.score))])]),a("el-collapse",{directives:[{name:"loading",rawName:"v-loading",value:e.libraryViewLoading,expression:"libraryViewLoading"}],staticClass:"collapse_main",attrs:{accordion:""},model:{value:e.dataInfo.subjectActive,callback:function(t){e.$set(e.dataInfo,"subjectActive",t)},expression:"dataInfo.subjectActive"}},e._l(e.dataInfo.subjectList,(function(t,n){return a("el-collapse-item",{key:n,attrs:{name:n}},[a("template",{slot:"title"},[a("el-row",{staticClass:"collapse_head",attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("span",[e._v(e._s(n+1+"、["+e.subjectTypeOptions[t.type-1].label+"]"+t.title))])])],1)],1),a("el-card",{staticClass:"collapse_card"},[[1,2].indexOf(t.type)>-1?a("div",[a("h4",[e._v("选项：")]),e._l(t.options,(function(t,n){return a("p",{key:n},[e._v(e._s(t.value+"、"+t.label))])}))],2):e._e(),a("h4",[e._v("答案：")]),a("div",{staticClass:"card_line"},[a("span",[e._v("正确答案：")]),a("span",[e._v(e._s(2===t.type?t.multiAnswer.join(""):t.answer))]),a("span",[e._v("分数：")]),a("span",[e._v(e._s(t.score))])]),a("h4",[e._v("解析：")]),a("div",{staticClass:"card_content"},[e._v(e._s(t.analysis))])])],2)})),1),a("div",{staticStyle:{"text-align":"right","margin-top":"15px"}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showPreview=!1}}},[e._v("关 闭")])],1)],1)],1)},s=[],i=(a("4160"),a("a15b"),a("d81d"),a("a434"),a("a9e3"),a("d3b7"),a("ac1f"),a("1276"),a("159b"),a("a397")),o=a("db13"),r={components:{Table:function(){return a.e("chunk-347ed62b").then(a.bind(null,"0748"))}},props:{attribute:{type:Number,default:1},disabled:{type:Boolean,default:!1},classOptions:{type:Array,default:function(){return[]}},usedLibrary:{type:Array,default:function(){return[]}}},data:function(){return{classHourID:Object(o["v"])("campus_ClassHourID"),showEdit:!1,editTitle:!0,showPreview:!1,searchLoading:!1,dataList:[],practiceLibraryList:[],form:{id:"",libraryID:"",attribute:"",classID:[],time:0},rulesTitle:{libraryID:{required:!0,message:"请选择试卷题库",trigger:"change"},classID:{required:!0,message:"请选择布置班级",trigger:"change"},time:[{required:!0,message:"试卷计时不能为空"},{type:"number",message:"试卷计时必须为数字值"}]},attributeOptions:[{label:"课前",value:1},{label:"课中",value:2},{label:"课后",value:3}],subjectTypeOptions:[{label:"单选题",value:1},{label:"多选题",value:2},{label:"判断题",value:3},{label:"问答题",value:4}],singleOptions:["A","B","C","D","E","F","G","H"],judgeOptions:["对","错"],btnLoading:!1,dialogChange:!1,dataEdit:!1,libraryViewLoading:!1,dataInfo:{id:"",title:"",time:0,score:0,subjectActive:0,subjectList:[]}}},computed:{dataColumn:function(){var e=[{Code:"title",Header:"题库名称",Fixed:"left"},{Code:"createTime",Header:"创建时间",Slot:!0},{Code:"operate",Header:"操作",Slot:!0,Width:450}];return 2!==this.attribute&&e.splice(1,0,{Code:"className",Header:"布置班级",Slot:!0,Fixed:"left"}),e}},created:function(){this.searchData(),this.getPracticeLibraryList()},methods:{closeDialog:function(){this.dialogChange&&this.searchData()},getPracticeLibraryList:function(){var e=this;this.practiceLibraryList=[],i["a"].IClassPractise.LibraryDataList().then((function(t){t.Result&&t.Datas&&t.Datas.length>0&&t.Datas.forEach((function(t){e.practiceLibraryList.push({label:t["PLTitle"]||"",value:t["PLID"]||""})}))})).catch((function(){}))},searchData:function(){var e=this;this.searchLoading=!0,this.dataList=[];var t=[];i["a"].IClassPractise.DataList(this.classHourID,this.attribute).then((function(a){a.Result&&a.Datas&&a.Datas.length>0&&(a.Datas.forEach((function(a){e.dataList.push({id:a.Datas["CPID"]||"",libraryID:a.Datas["PLID"]||"",attribute:a.Datas["Attribute"],state:a.Datas["State"]||0,createTime:a.Datas["CreateTime"]||"",title:a["Title"]||"",classID:a["ClassID"]||"",className:a["ClassName"]||"",taskId:a["CIPID"]||""}),t.push(a.Datas["PLID"]||"")})),e.$refs["table"].MaxTblHeight=500),e.searchLoading=!1,e.$emit("load",t)})).catch((function(){e.searchLoading=!1,e.$emit("load",t)}))},resetForm:function(e){this.$refs["form"]&&this.$refs["form"].resetFields(),console.log(e),this.form={id:e?e.id:"",libraryID:e?e.libraryID:"",classID:e?e.classID.split(","):[]}},addData:function(){this.resetForm(),this.showEdit=!0},editData:function(e){this.dataEdit=!0,this.resetForm(e),this.showEdit=!0},saveForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.warning("请输入正确格式"),!1;t.btnLoading=!0;var a="";2!==t.attribute&&(a=t.form.classID.join(",")),i["a"].IClassPractise.DataSave(t.form.id,t.classHourID,t.form.libraryID,t.attribute,a).then((function(e){e.Result?(t.dialogChange=!0,t.showEdit=!1,t.$message.success(t.form.id?"修改成功！":"创建成功！")):e.Info&&t.$message.error(e.Info),t.btnLoading=!1})).catch((function(){t.btnLoading=!1}))}))},beforeShowPreview:function(e){this.getDataInfo(e),this.showPreview=!0},getDataInfo:function(e){var t=this;this.dataInfo.subjectList=[],this.dataInfo.title=e.title||"",this.dataInfo.time=e.time||0,this.dataInfo.score=0,this.libraryViewLoading=!0,i["a"].IClassPractise.LibraryDataView(e.libraryID).then((function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach((function(e){t.dataInfo.subjectList.push({libraryID:e.Key["PLID"],id:e.Key["PSID"],no:e.Key["PSSerial"]||0,title:e.Key["PSContent"],type:e.Key["PSType"],score:e.Key["PSScore"]||0,analysis:e.Key["PSanalysis"],answer:e.Key["PSAnswer"],multiAnswer:2!==e.Key["PSType"]?[]:e.Key["PSAnswer"].split(""),options:4===e.Key["PSType"]?[]:e.Value.map((function(e){return{label:e["SOContent"],value:e["SOSerial"]}}))}),t.dataInfo.score+=e.Key["PSScore"]||0})),t.libraryViewLoading=!1})).catch((function(){t.libraryViewLoading=!1}))},dataDrop:function(e){var t=this;this.$confirm("此操作将删除随堂练习, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.classID=e.classID,t.dataDelete(e)}))},dataDelete:function(e){var t=this;i["a"].IClassPractise.DataDelete(e.id).then((function(e){e.Result?(t.$message.success("删除成功"),t.searchData()):e.Info&&t.$message.error(e.Info)})).catch((function(){t.$message.error("操作失败")}))},closePreviewDialog:function(){this.dataEdit=!1},studentTask:function(e){Object(o["y"])("campus_ClassPractice",e),Object(o["y"])("campus_TaskType","ClassPractice"),this.$router.push("/p/task")}}},l=r,c=(a("0bc4"),a("2877")),u=Object(c["a"])(l,n,s,!1,null,null,null);t["default"]=u.exports},e9d8:function(e,t,a){},f2da:function(e,t,a){"use strict";a("08d4")}}]);
//# sourceMappingURL=chunk-badd3dc4.202312271831.6a069efe.js.map